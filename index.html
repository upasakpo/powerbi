<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Power BI Dashboard — GitHub Pages</title>
  <meta name="description" content="Interactive Power BI report embedded for public viewing." />
  <style>
    /* Simple responsive layout */
    html,body { height:100%; margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; background:#f6f7fb; color:#111; }
    .wrap { display:flex; flex-direction:column; min-height:100%; }
    header { padding:16px 20px; background:linear-gradient(90deg,#0f62fe,#6fb1ff); color:white; }
    header h1 { margin:0; font-size:1.125rem; }
    .container { flex:1; display:flex; gap:20px; padding:20px; align-items:flex-start; justify-content:center; }
    .frame-wrap { width:100%; max-width:1200px; height:75vh; background:white; border-radius:10px; box-shadow:0 6px 20px rgba(8,16,40,0.08); overflow:hidden; }
    iframe { width:100%; height:100%; border:0; display:block; }
    .controls { max-width:1200px; margin:12px auto 32px; padding:12px 16px; background:#fff; border-radius:8px; box-shadow:0 4px 16px rgba(8,16,40,0.04); }
    .small { font-size:0.9rem; color:#333; }
    .muted { color:#666; font-size:0.85rem; }
    .link { color:#0f62fe; text-decoration: none; }
    .warning { color:#7a1c1c; background:#fff0f0; border-left:4px solid #ff6b6b; padding:10px 12px; border-radius:4px; margin-top:8px; }
    @media (max-width:700px) {
      .frame-wrap { height:62vh; }
      header h1 { font-size:1rem; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Power BI Dashboard — Public Viewer</h1>
    </header>

    <main class="container" role="main">
      <div style="width:100%; max-width:1200px;">
        <!-- Frame container -->
        <div class="frame-wrap" aria-label="Embedded Power BI report">
          <!-- Replace EMBED_URL below with your Publish-to-web embed URL -->
          <!-- Example embed URL format: https://app.powerbi.com/view?r=eyJrIjoi... -->
          <iframe
            id="pbiframe"
            title="Power BI report"
            src="REPLACE_WITH_PUBLISH_TO_WEB_EMBED_URL"
            allowfullscreen
            loading="lazy"
            sandbox="allow-same-origin allow-scripts allow-popups allow-forms">
          </iframe>
        </div>

        <div class="controls" role="region" aria-label="report info">
          <p class="small">
            <strong>How to get the embed URL</strong> — In Power BI Service:
            <em>File → Embed report → Publish to web (public)</em>. Copy the URL (or iframe).
            Paste the URL in the <code>src</code> attribute above.
          </p>

          <p class="muted">
            Tip: if the page shows a message “This content isn’t available”, double-check you pasted a valid <code>https://app.powerbi.com/view?r=…</code> publish-to-web link.
          </p>

          <div class="warning" role="alert">
            ⚠️ <strong>Security notice:</strong> Using Publish to web makes the report publicly accessible to anyone who has the URL. Do NOT use this method for internal or confidential data.
          </div>

          <p style="margin-top:12px;">
            <a id="openNewTab" class="link" href="#" target="_blank" rel="noopener">Open report in a new tab</a>
          </p>
        </div>
      </div>
    </main>
  </div>

  <script>
    // If user forgets to replace the URL, show helpful fallback content.
    (function(){
      const iframe = document.getElementById('pbiframe');
      const openLink = document.getElementById('openNewTab');
      const placeholder = 'REPLACE_WITH_PUBLISH_TO_WEB_EMBED_URL';
      if (!iframe.src || iframe.src.trim() === '' || iframe.src.includes(placeholder)) {
        // Show a light fallback page inside iframe (data URL) instead of blank.
        const fallbackHtml = encodeURIComponent(
          '<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>No report</title></head><body style="font-family:system-ui,Segoe UI,Arial;padding:24px;color:#111;"><h2>No Power BI embed URL found</h2><p>Replace the <code>src</code> in <code>index.html</code> with your publish-to-web URL.</p></body></html>'
        );
        iframe.src = 'data:text/html;charset=utf-8,' + fallbackHtml;
        openLink.href = '#';
        openLink.addEventListener('click', function(e){ e.preventDefault(); alert('Replace the src in index.html with your publish-to-web URL, then commit/push.'); });
      } else {
        openLink.href = iframe.src;
      }
    })();
  </script>
</body>
</html>
